--- 
wordpress_id: 447
layout: post
title: !binary |
  5re65YWl5re65Ye6IGlmcmFtZSAoMik=

date: 2007-08-24 22:51:14 +08:00
wordpress_url: http://blog.xdite.net/?p=447
---
<p>再來一下上一篇用到的 iframe 圖吧。</p>
<p><a href="http://www.flickr.com/photos/14765209@N00/1221356930/" title="相片分享"><img width="240" alt="iframe01" height="180" src="http://farm2.static.flickr.com/1149/1221356930_5ff446cf2b_m.jpg"/></a></p>
<p>我們可以很清楚的看到，如果不加預設參數，就是這樣的大小。等等？<strong>可以改變大小？</strong></p>
<p>是的。如果你要讓它放很大或放很小，只要去改 &lt;iframe width="123" hight="456 src="123.htm"&gt;&lt;/iframe&gt; 裡面的寬高就行了。愛動壞心眼的人，一定會想到這樣可以怎樣惡搞？我把寬高，<span style="COLOR: #ff0000">都改成 0 不就誰都看不見了</span>嗎？</p>
<p>是的，所以常見用 iframe 插木馬或病毒法都是使用這一招。具體手法就是打下某熱門網站把修改它們的正常網頁，然後偷加一條寬高為 0 的 iframe 語法去呼叫有問題的網頁進來。好躲嗎？不好躲。因為現在瀏覽器可以不執行 javascript，可是通常都會執行頁框。所以很多人就換 iframe 插。除非你的 browser 又掛了可以阻攔頁框的 plugin ....否則 ...</p>
<p>具體範例：上次 <a href="http://blog.xdite.net/?p=422">無名小站被 Avast 警示「<span style="COLOR: #ff0000"><strong>HTML:Iframe Exploit</strong></span>」</a>事件。</p>
<p>為什麼會被防毒軟體抓呢？因為這就是著名的 iframe 攻擊手法。<strong>把寬高都設為 "0" 或都設為 "1" 隱藏起來</strong>。無名小站的設計恰好就是，如果你能執行 javascript，他就呼叫某某網頁。如果你不執行 javascript 呢？沒關係，我再開 iframe 對付你。所以被防毒軟體判斷為惡意是很正常的。</p>
<p>那某些人可能又會想到啦，如果 0,0 和 1,1 都會被逮。那我改成 0,123 或者是 1,321 呢？好方法，這樣就抓不到 XD。大陸現在很多變形手法就是這樣玩的，讓防毒軟體根本就無法靠死規則來逮你。（from <a href="http://hitcon.org/hit2007">HIT2007</a> Birdman's speech）</p>
<p>不過，是只要能解析 iframe 語法的瀏覽器就會中獎嗎？這也不見得。因為木馬和病毒要能打的進來，還是要靠你的幫忙。</p>
<p>(1) 你的 OS 沒有及時修補。<br/>(2) 你的瀏覽器存在漏洞沒有及時修補。<br/>(3) 你連防毒軟體都沒裝。</p>
<p>(2) 問題比較不大。為什麼呢？因為某些不是 IE 的瀏覽器都有自動修補行為。而微軟系的，規定你要是正版的 OS 才給你補 ...XD<br/>不過最可怕的還是 (3)，筆者還曾經遇過洋洋得意的使用者，向我炫耀他從不灌防毒軟體，卻從沒中過毒。我打開它的工作管理員一看後.....心中默默下了一個決定：「還是不要摧毀他美麗的幻想好了」，免得他拉不下臉來，又找我理論一番。</p>

---

<p>很多人都有個錯誤的觀念，我的電腦沒變慢，就是我沒中毒。大錯特錯，到了變慢，那已經是你病入膏肓的時候了，通常解藥只有；「東西備一備，砍掉重練」。更何況這世上，存在的並不只有病毒，還有木馬、蠕蟲等等，它們是不會要你命的，因為它們作的是安靜的蟄伏，往外送你的資料密碼。你覺得沒有中毒，是因為你根本不知道你現在執行的 process 到底是些什麼東西，更何況有些人還不知道，process 是可以隱藏的 XD。 for your own good , install antivirus software!</p>
<p><strong>盜帳號？</strong></p>
<p>接下來，我要講的是盜帳號問題。國內兩三年前，曾有一波嚴重的災情，便是遊戲帳號被盜。</p>
<p>從哪盜的呢？官網與假官網。<br/>盜什麼？盜 Cookie。</p>
<p>我在前面說過了，iframe 可以變得很小，所以具體手法有兩種，一種是打下官網改網頁偷 cookie。一種就是自己作個假官網，include 真官網，騙帳號密碼。都是用 iframe 實現。這就是為什麼 iframe 跟盜帳號密碼扯上關係的原因。</p>
<p>第二種比較難防，因為防禦取決於使用者智商。</p>
<p>第一種，就比較歸咎於網站設計者的責任。所謂的 Cookie，會涵蓋你一些登入的資訊，讓你通行網站的各個地方，而不需要經過一次又一次的驗證。但是呢？缺乏心眼的設計者，可能就會忘記去檢查有 cookie 的人，是不是跟剛剛的同一人。</p>
<p>會被盜用帳號的原因通常是網站缺乏以下防禦：</p>
<p>(1) cookie 沒有過期時間</p>
<p>(2) cookie 沒有鎖定使用來源</p>
<p>(3) cookie 隱藏某些使用資訊。或者是網站密碼與遊戲密碼相同。</p>
<p>所以你看到目前遊戲網站做的機制，都是在防堵這類情形的再度發生。花時間偷聽和用 keylogger 盜帳號實在太麻煩，打網站幹 db 或幹 cookie 冒充使用者既快速又方便，何樂而不為呢？</p>
<br/><p>結論，這是 iframe 的錯嗎？當然不是。只是 iframe 的特性能讓這些攻擊手法達到目的。所以你要作的 secure 你本身，而不是去責怪 iframe 如何又如何。</p>

---
補充：
剛剛寫完，看到 gslin 大神最近寫了一篇「<a href="http://blog.gslin.org/archives/2007/08/24/1283/">CSS攻擊法</a>」，裡面寫到如何用 CSS 配上 iframe 讓使用者誤擊某些不安全的操作。
